# 🔍 输入数值后其他币种不显示 - 问题排查

## 📋 请按以下步骤排查

### 步骤 1：打开浏览器控制台

**Mac**: `⌘ + ⌥ + I`  
**Windows**: `F12`

查看是否有以下信息：

#### ✅ 正常情况应该看到：
```
App Launch
App Show  
主页加载
✅ 汇率数据获取成功
或
📦 加载内置默认汇率数据
```

#### ❌ 如果看到错误：
- 红色错误信息
- "请求失败"
- "未定义"
- 请截图告诉我

---

### 步骤 2：检查汇率数据是否加载

在控制台（Console）中输入以下命令：

```javascript
// 检查汇率数据
console.log('汇率数据:', localStorage.getItem('exchangeRates'))

// 检查已选币种
console.log('已选币种:', localStorage.getItem('selectedCurrencies'))
```

**预期结果**：
- 应该看到一大段 JSON 数据
- 如果显示 `null`，说明数据未加载

---

### 步骤 3：使用调试工具

我已经创建了一个调试工具，请按以下步骤使用：

#### 方法 1：在浏览器中打开
```
1. 在浏览器地址栏输入：
   http://localhost:5173/调试工具.html
   或
   http://localhost:8080/调试工具.html

2. 点击"检查存储数据"
3. 查看结果
```

#### 方法 2：直接打开文件
```
在 Finder 中找到：
/Users/tongyao/Desktop/开发/app/汇率速算/调试工具.html

双击打开
```

---

### 步骤 4：执行快速修复

如果调试工具显示数据缺失：

```
1. 在调试工具中点击"执行快速修复"
2. 等待提示"修复完成"
3. 回到应用页面
4. 刷新页面（⌘ + R 或 F5）
5. 重新测试输入
```

---

## 🔍 具体测试步骤

### 测试 1：检查页面加载

1. 打开应用（http://localhost:5173 或 8080）
2. 应该看到 3 个币种卡片：
   - 🇨🇳 CNY 人民币
   - 🇺🇸 USD 美元
   - 🇪🇺 EUR 欧元

**如果没有显示**：
- 说明组件没有正确加载
- 查看控制台错误信息

### 测试 2：输入金额

1. 点击"人民币 CNY"卡片
2. 应该弹出数字键盘
3. 输入：1000
4. 查看其他币种

**预期结果**：
- USD 应显示约：138.xx
- EUR 应显示约：128.xx

**如果没有显示**：
- 查看控制台是否有计算错误
- 继续下面的排查

### 测试 3：手动触发计算

在控制台输入：

```javascript
// 手动检查计算函数
const testAmount = '1000'
const testFromCode = 'CNY'
const testToCode = 'USD'
const testRates = { CNY: 7.25, USD: 1 }

// 计算公式: amount / fromRate * toRate
const result = (1000 / 7.25) * 1
console.log('计算结果:', result) // 应该显示约 137.93
```

---

## 🐛 常见问题和解决方案

### 问题 1：汇率数据为空

**症状**：
- 控制台显示 `exchangeRates: null`
- 或 `未找到汇率数据`

**解决方法**：

```javascript
// 在控制台执行以下代码设置默认数据
const defaultRates = {
  'USD': 1, 'CNY': 7.25, 'EUR': 0.93, 
  'GBP': 0.79, 'JPY': 149.85
}
localStorage.setItem('exchangeRates', JSON.stringify(defaultRates))
localStorage.setItem('ratesBase', 'USD')
localStorage.setItem('ratesLastUpdate', Date.now())

// 刷新页面
location.reload()
```

### 问题 2：币种数据为空

**症状**：
- 页面上没有币种卡片
- 或只显示"添加币种"按钮

**解决方法**：

```javascript
// 设置默认币种
localStorage.setItem('selectedCurrencies', JSON.stringify(['CNY', 'USD', 'EUR']))

// 刷新页面
location.reload()
```

### 问题 3：计算不准确

**检查**：
- 汇率数据是否正确
- big.js 是否正确加载

**解决方法**：

```javascript
// 检查 big.js 是否可用
console.log('big.js:', typeof Big)  // 应该显示 'function'

// 测试计算
const Big = require('big.js')
const result = new Big(1000).div(7.25)
console.log('测试计算:', result.toString())
```

### 问题 4：键盘输入没反应

**检查**：
- 键盘是否弹出
- 控制台是否有错误

**解决方法**：
- 检查 v-model 绑定
- 查看 handleInput 函数是否执行

---

## 🎯 临时解决方案

如果以上方法都不行，可以使用以下**临时代码修复**：

在浏览器控制台中执行：

```javascript
// === 完整的临时修复脚本 ===

// 1. 设置默认汇率
const rates = {
  'USD': 1, 'EUR': 0.93, 'GBP': 0.79, 'JPY': 149.85,
  'CNY': 7.25, 'HKD': 7.83, 'AUD': 1.52, 'CAD': 1.36,
  'CHF': 0.88, 'SGD': 1.34, 'KRW': 1340, 'TWD': 32,
  'THB': 35.5, 'NZD': 1.65, 'INR': 83.5, 'BRL': 5.65
}

localStorage.setItem('exchangeRates', JSON.stringify(rates))
localStorage.setItem('ratesBase', 'USD')
localStorage.setItem('ratesLastUpdate', Date.now())

// 2. 设置默认币种
localStorage.setItem('selectedCurrencies', JSON.stringify(['CNY', 'USD', 'EUR']))

// 3. 清空金额
localStorage.setItem('currencyAmounts', JSON.stringify({}))

// 4. 设置配置
const settings = {
  locale: 'zh-CN',
  decimalPlaces: 2,
  thousandSeparator: ',',
  theme: 'auto',
  autoUpdate: true
}
localStorage.setItem('settings', JSON.stringify(settings))

console.log('✅ 临时修复完成，请刷新页面')

// 5. 自动刷新
setTimeout(() => location.reload(), 1000)
```

---

## 📸 需要您提供的信息

为了更好地帮助您，请提供以下信息：

### 1. 控制台截图
- Console 标签的内容
- 特别是红色错误信息

### 2. Network 标签
- 是否有网络请求
- 请求状态（成功/失败）

### 3. Application 标签
- Local Storage 中的数据
- 是否有 exchangeRates 项

### 4. 具体操作步骤
- 您点击了哪个币种
- 输入了什么数字
- 其他币种是否完全没反应，还是显示了但金额为 0

---

## 🚀 推荐操作流程

```
1. 打开调试工具.html
   ↓
2. 点击"检查存储数据"
   ↓
3. 如果数据缺失，点击"执行快速修复"
   ↓
4. 回到应用页面刷新
   ↓
5. 重新测试输入
   ↓
6. 如果还是不行，截图控制台发给我
```

---

**请按照以上步骤排查，然后告诉我：**

1. ✅ **"修复成功"** - 太好了！
2. 📸 **"这是控制台截图"** - 我会分析错误
3. ❓ **"调试工具显示 XXX"** - 我会给出针对性方案

随时等待您的反馈！💪

